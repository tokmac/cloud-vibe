@using Cloud_Vibe.Utilities
@model ICollection<Cloud_Vibe.Models.ViewModels.CommentViewModel>

<div class="container">
    <div class="row">
        <div class="row jumbotron col-md-6 col-md-offset-3">
            @using (Html.BeginForm("Comments", "User", new { type = ViewBag.Type, id = ViewBag.id }, FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="row">
                    <div class="col-md-10 col-md-offset-1">
                        <textarea rows="9" name="comment" required placeholder="Add comment..." class="form-control"></textarea>
                    </div>
                </div>
                <hr />
                <div class="row">
                    <span class="input-group input-group-lg col-md-4 col-md-offset-4">
                        <button class="btn btn-lg btn-block btn-warning" type="submit">Add Comment</button>
                    </span>
                </div>
            }
        </div>

    </div>
    <hr />
    <div class="row">
        @if (Model.Count == 0)
        {
            <h1>No comments yet</h1>
        }
        @foreach (var comment in Model)
        {
            <div class="row">
                <div class="col-md-2">
                    <div class="row">
                        <h3>@comment.User.UserName</h3>
                    </div>
                    <div class="row">
                        <!--Image Container-->
                        @{
            var avatar = comment.User.Avatar;
            var img = FilesByteUtility.ByteArrayToImageSrcString(avatar);
                        }
                        <img src="@img" class="thumbnail img-rounded img-responsive" style="float:left;height:120px; margin-right:10px" />
                    </div>
                    <div class="row">
                        <p>Posted @Html.Timeago(comment.PostedOn)</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <p>@comment.Text</p>
                </div>
            </div>

            <hr/>
        }
    </div>
</div>

